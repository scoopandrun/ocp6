{% extends "base.html.twig" %}

{% block title %}
  {{ trick.name ? trick.name ~ " - Edit" : "Create trick" }}
{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  <link rel="stylesheet" href="{{ asset('styles/trick/single.css') }}">
  <link rel="stylesheet" href="{{ asset('styles/trick/edit.css') }}">
{% endblock %}

{% block body %}

  {# <header>
    {% if trick.id %}
      <div class="container mx-3 mx-sm-auto my-5 text-center thumbnail">
        <img
        src="{{ trick.thumbnail.url ?? asset('images/fallback-trick-image-1920.jpg') }}"
        class="thumbnail__image rounded"
        alt="{{ trick.name }}"
        >
        <div class="thumbnail__overlay rounded-bottom">
          <h1 class="thumbnail__trick-name">{{ trick.name }}</h1>
        </div>
      </div>
    {% else %}
      <div class="container text-center">
        <h1>Create trick</h1>    
      </div>
    {% endif %}
  </header> #}

  <header>
    <div class="container text-center">
      <h1>{{ trick.id ? "Edit trick" : "Create trick" }}</h1>    
    </div>
  </header>

  <main>
    <div class="container mb-5">
      {# {{ form(form, {'attr': {'id': form.vars.id} }) }} #}

      {{ form_start(form, {'attr': {'id': form.vars.id, 'class': 'trick-edit-form'} }) }}

        {{ form_row(form.name) }}

        <fieldset
          class="mb-3"
          data-prototype="{{ form_widget(form.pictures.vars.prototype)|e('html_attr') }}"
          data-controller="{{ form.pictures.vars.attr['data-controller'] }}"
          data-add-button-text="{{ form.pictures.vars.attr['data-add-button-text'] }}"
        >
          <legend>Pictures</legend>

          {% for picture in form.pictures %}
            {{ include('trick/includes/_picture-form.html.twig') }}
          {% endfor %}
        </fieldset>

        {% do form.pictures.setRendered %}
        
        {{ form_row(form.category) }}

      {{ form_end(form) }}
      
      <div class="d-flex">
        <input
          type="submit"
          value="{{ trick.id ? 'Save changes' : 'Create new trick' }}"
          form="{{ form.vars.id }}"
          class="btn btn-primary"
        >

        {% if trick.id %}
          <form action="{{ path('trick.delete', {id: trick.id}) }}" method="post">
            <input type="hidden" name="_method" value="DELETE">
            <button
              class="btn btn-danger ms-3"
              type="submit"
              value="Delete"
              data-action="delete"
            >Delete</button>
          </form>
        {% endif %}
      </div>

    </div>
  </main>
{% endblock %}
